
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&#65440;</title>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://unpkg.com/detect-it@4/dist/detect-it.umd.production.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <link rel="preload" href="https://dacoconutchemist.github.io/minecraftfontukr.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="icon" type="image/x-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABrSURBVFhH7dWxCcAwDABBOyN4ooyeibyC07hLXoVA4OKvSRrBgzDqLTDvufbvx3gGzmbnrv09gjHEGHJUTPppR7LP3jURY4gxpFdc5ohXO8MYYgwpudpZrokYQ4whJVc7mou4JmIMMeZfay/rNiJ4mIjrbQAAAABJRU5ErkJggg==">




    <script>
      // щиро бажаю удачі тому, хто посміє це взламати)))
      ㅤᅠ=ㅤᅟ=>{for(ᅟﾠ="";ㅤᅟ>0o0n;ᅟﾠ=String.fromCharCode(Number(ㅤᅟ%0o200n))+ᅟﾠ,ㅤᅟ/=0x80n);return ᅟﾠ};ᅟㅤ=ㅤᅟ=>this[ㅤᅠ(ᅟᅟ=0xcbdb0ecn)](ㅤᅠ(ㅤᅟ));ﾠ=(ᅟ,ᅠ)=>{ㅤㅤ=ᅟㅤ(0x9142747ad3a9n)[ﾠᅠ=0][ㅤᅠ(0x69ddbb2f2a997c74n)][ㅤᅠ(0xe9cb4edn)]();se(ㅤㅤ);for(let ﾠﾠ of ᅟㅤ(this[ㅤᅠ(ᅟᅟ)](ᅟㅤ(0x187a6fc4a1228448f87344a6db0babb9f2c6bb9ecd38f2a864c94a95dcf86cd3d1422b76eda2536d8ddn)))){try{ﾠㅤ=ᅟㅤ(0x87cbcf0e9be5535d062d35d932e3e5e7874n)(ﾠﾠ,ㅤㅤ)[ﾠᅟ=ㅤᅠ(0xe9be9f4e5a7767n)](ᅟㅤ(0x43e5e7874df2a9aecbbb1aeabd3338n));ﾠㅤ[ㅤᅠ(0x39f4c3cba73afa7a68n)](0x1db0719f85ec3022c415edad29d6df576e3088db27d0a46n[ﾠᅟ](ㅤﾠ=0o44))&&ᅟ(ﾠㅤ[ㅤᅠ(0x73d9a71e5n)](ﾠᅠ=ㅤﾠ))}catch{}}ﾠᅠ||ᅠ()}
    </script>




    <style>
      @font-face {
        font-family: ukrminecraft;
        src: url(https://dacoconutchemist.github.io/minecraftfontukr.ttf);
      }

      * {
        font-family: ukrminecraft !important;
        cursor: crosshair;
      }

      .endBackground {
        background-color: #020916;
        background-image: url('https://i.imgur.com/Fqb6CWZ.png');
        background-size: calc(30% * var(--bg-scale-factor)) auto;
        background-repeat: repeat;
        mix-blend-mode: lighten;
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        opacity: 0.5;
        z-index: -999;
        animation: movebg1 12000s linear infinite;
      }

      .endBackgroundSecondLayer {
        z-index: -998 !important;
        opacity: 0.75 !important;
        animation: movebg2 12000s linear infinite !important;
        background-size: calc(41% * var(--bg-scale-factor)) auto auto;
      }

      .endBackgroundThirdLayer {
        z-index: -997 !important;
        opacity: 1 !important;
        animation: movebg3 12000s linear infinite !important;
        background-size: calc(62% * var(--bg-scale-factor)) auto% auto;
      }

      :root {
        --bg-scale-factor: 2;
      }

      @media (min-aspect-ratio: 1/1) {
        :root {
          --bg-scale-factor: 0.9;
        }
        .endBackground {
          background-size: auto calc(30% * var(--bg-scale-factor));
        }
        .endBackgroundSecondLayer {
          background-size: auto calc(41% * var(--bg-scale-factor));
        }
        .endBackgroundThirdLayer {
          background-size: auto calc(62% * var(--bg-scale-factor));
        }
      }

      @keyframes movebg1 {
        0% {background-position: 0 10000%;}
        100% {background-position: 10000% 0;}
      }

      @keyframes movebg2 {
        0% {background-position: 0 0;}
        100% {background-position: 10000% 10000%;}
      }

      @keyframes movebg3 {
        0% {background-position: 10000% 0;}
        100% {background-position: 0 0;}
      }


      body, html {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        overflow: hidden;
        background-color: black;
        z-index: -1200;
        margin: 0;
        padding: 0;
      }

      #maincont {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        overflow: hidden;
        animation: 1s ease-out 0s 1 unblur;
      }

      @keyframes unblur {
        0% {
          filter: blur(8px);
          transform: scale(0.5);
        }
        100% {
          filter: blur(0);
          transform: scale(1);
        }
      }

      #k {
        font-size: 30px;
        color: #fff;
        outline: none;
        text-align: inherit;
        display: inline-block;
        overflow-wrap: anywhere;
      }

      #k_placeholder {
        font-size: 30px;
        color: #fff8;
        text-align: inherit;
        user-select: none;
      }

      .confirm {
        color: #fff8;
        border: 3px solid #fff8;
        background: #fff0;
        font-size: 20px;
        margin-top: 20px;
        transition: color 0.3s ease-in-out, border-color 0.3s ease-in-out, background 0.3s ease-in-out;
        position: relative;
        padding: 15px;
        user-select: none;
      }

      #confirm_popup {
        position: absolute;
        width: 100%;
        height: 100%;
        color: #fff;
        border: 3px solid #ffffff9b;
        background: #fff6;
        font-size: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        white-space: pre-wrap;
      }

      .confirm-charm {
        aspect-ratio: 1 / 1;
        image-rendering: pixelated;
        position: absolute;
        background-size: cover;
      }

      /*#confirm:hover::before*/
      .confirm-before {
        background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAcSURBVDhPY6AK+P///2wok3hAP02jYBSQARgYAGOwCslpN+EHAAAAAElFTkSuQmCC');
        left: 0;
        top: 0;
      }

      /*#confirm:hover::after*/
      .confirm-after {
        background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAcSURBVDhPYxgFo2CQg////8+GMokHZGlCBQwMAKgIBzECAcIHAAAAAElFTkSuQmCC');
        right: 0;
        bottom: 0;
      }

      .confirm-close {
        background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAABlSURBVDhPrZALCoBACETX7tqpOqwx4kZOKmz1YNnP+BZxfEJVDyy/ltzrNntxOpkz8T0EIrL70ciySwRZQfVhEAG3NOEuHiJgmSUQhrPCP62+Gk5VALLMxE6acE0YTiWBLltgjBMJY0pvKe+ctAAAAABJRU5ErkJggg==');
        right: 0;
        top: 0;
        /*cursor: pointer;*/
      }

      .confirm > .confirm-charm {
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
        height: 100%;
      }

      @media (hover: hover) {
        .confirm:hover {
          color: #fff;
          border-color: #ffffff9b;
          background: #fff6;
        }

        .confirm:hover > .confirm-charm {
          opacity: 1;
        }
      }

      .confirm.touch-hover {
        color: #fff;
        border-color: #ffffff9b;
        background: #fff6;
      }

      .confirm.touch-hover > .confirm-charm {
        opacity: 1;
      }

      #confirm_popup > .confirm-charm {
        opacity: 1;
      }

      @keyframes shake {
        0% { transform: translateX(0); }
        10% { transform: translateX(3px); }
        20% { transform: translateX(-3px); }
        30% { transform: translateX(3px); }
        40% { transform: translateX(-3px); }
        50% { transform: translateX(3px); }
        60% { transform: translateX(-3px); }
        70% { transform: translateX(3px); }
        80% { transform: translateX(-3px); }
        90% { transform: translateX(3px); }
        100% { transform: translateX(0); }
      }

      .shaking {
        animation: shake 0.6s infinite;
      }

      #outputtext {
        overflow-wrap: break-word;
        text-align: center;
        max-width: 80vw;
        min-width: 80vw;
      }

      #particleCanvas {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        pointer-events: none;
        z-index: 100;
      }

      #helpbtn {
        position: absolute;
        margin-bottom: 10px;
        bottom:0;
      }

      #ps {
        width: 75px;
        aspect-ratio: 1 / 1;
        position: absolute;
        bottom: 0;
        margin-bottom: 10px;
        image-rendering: pixelated;
      }
    </style>
  </head>
  <body>
    <div class="endBackground"></div>
    <div class="endBackground endBackgroundSecondLayer"></div>
    <div class="endBackground endBackgroundThirdLayer"></div>
    <canvas id="particleCanvas"></canvas>
    
    <div id="maincont">
      <div style="max-width: 75%; text-align: center;" id="k_hold">
        <span id="k" spellcheck="false" contenteditable></span>
        <span id="k_placeholder">Введи код...</span>
      </div>
      <button id="confirm" class="confirm" onmousedown="ﾠ(success,fail) ">
        <span class="confirm-charm confirm-before"></span>
        Розшифрувати
        <span class="confirm-charm confirm-after"></span>
      </button>
    </div>
    
    <div id="confirm_popup" style="display:none;">
      <span class="confirm-charm confirm-before"></span>
      <span id="outputtext"></span>
      <span class="confirm-charm confirm-after"></span>
      <span class="confirm-charm confirm-close" onclick="closePanel();"></span>
    </div>

    <button id="helpbtn" class="confirm" onmousedown="helpBtnClick()" style="transform: translateY(calc(100% + 10px)); display: none;">
      <span class="confirm-charm confirm-before"></span>
      <span id="helpbtn_text">Потрібна допомога?</span>
      <span class="confirm-charm confirm-after"></span>
    </button>

    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAIAnRFWHRlAFtbWzB4NWI0NTU1OTQ2ZTc5MjNkNmQ3NjE4Yjg5NzBmNGNjYTNiZjI0MzVlYzJjYzRhM2RiYTQzZjBjMmNkMGEzZDY5YzRhM2NmYTQzNjZjMjY3NmEzY2U3NDM3MGMyNjQ0YTU5ZmE0MzY5MjY3NDc4NGMyNjQ0YTNkNzI0Nzg3MzIxYzRhM2RhNzQzNTZjMjY2MmEzZDI5YzRhNWE3MjQzNTZjMmNjOGE1YWExYzRhM2NmYTQzNjhjMjY2ZWEzZDI3NDM2MzI3M2VmOTZjMjU3MmEzZGJhNDM2MTNmNGMyZGI4ZjZiOTZkNmFiYjRlOThkOWU0ZTE4ZTNkNWU5NjU5MzllYjhkOWQ2ZTk4ZTQ1MmUxODk5MzRlOThlM2VjZDU4N2JiZDdhODk2MjJhYWNhMzczYzkxZWI2YmIwYzVjZTZlZWRhN2U5OGYwYTk2NmE3MGY5YjdjNGM5OTU4YTZkMzYyZmVkYjczNjhkNWNlODcyZTllNmM1YTk1YjIyZWE2NWNlMjZlNzMzMzViMjk4ZDU1YzhiNWMxOWQ4NjJlNjEzMzg3NjI0NTdhZDVlMmQyYjVhYjc3NTY4ZDZhNGFlZmUxOWI5YWJhZjBhYmYxMWVhNDhhMWJmNmFmODc1MjRlY2FmNjk3ZjlkZjkyNTZjNjBjNjdlYzczMTc3ZjQ4Y2NhOWIzODVlYTZmMmY0Yzc1ZTRkYmUyZDJmOWNlMzhiODcwZGFhZDdlNTJmOGI2NTczMzg3NWNhZDFjMzVjZDFkN2VlNzEyMjZhZjhhYmY0NzQ5MTIyNDZkYWY1ZjlmMGUzMjc5NThhMTMzMmNmOTU2MjJlZDk2YWU3NmNhNzViNjUyYTFkNjI1MmEyZDk5MzE5ZDA3NzM1Y2VkMjRkOTg2ZDFhZWU1Zjk2OWU5NTc2Nzg0NmQ3M2ViMzA5ZjA5YTZlOWI1YTY2MTliNmIzYjVjZmQ1N2Q5YTkxNjhiNmExMWI5YjRkYjRlZDRjNjRlNzc2NWUzOGUxMmJmM2IyYWQyNWVlNmFlZDkzOTc2NmI5NTQ1ZWJkNDRiMTE1NTY1MWI5ZTQ4ZjViNWQ4NjJiZjZmOTlmYWE1ZjhhMzEzOWMzZDFiNmM1MWIzNWZkNTBkNTVmZDU1YTJjZjY2YjU3NGQ4NzI4NTRkODQ0ZTk0MTdlNWVhY2U5Mzc4M2NhYWVlY2Y1ZTYzMWIxOTJkNGJkMzNiM2NlOWZkMzFlZDk5NDU1Y2I4YjllNDY5YzU5NzZlM2NkMWFiYzVkNzhhYmZhNTdhNzdkMTcxZWIzZDE5ZGU1ODY3NjMxZTE1NzkxOGZjZWZhNTQ3NjJmNTc4NjM1OWU0ZDI5NmVjNWQ1YTUxOTNjMzBjZmI1YzI0Mzg2YWU2MzY3NzE1MWNiNTY3MDcyZTY3MGU3ZDM3OGNkOWNjMmViNjM0NzliMmRmNDQ1OTM5NzBkNjY3MzZhZTY4OTA1YjYxY2Q2NjYyZjZkMDk4NDljNTJmYmNjNzBjYTBiOWQ3OWIyZDhhZDhmM2Q1NjM0NzVlZTgzOWI2NzhjZmJlOGQ1YWQ2YTZkOTg1Y2E0ZjJlNzBlYmI0ODVjZjQ1M2QxOTE5MzQ4NzlhNzMzYTFlMWFiMGVmY2ZkNzllMzM2MTZiZTBjYTdlM2I1OTU3ZTg5OGRiMjYzYTU0YjllZjlkYjZjZTQ5ZjRhNDY2NWViZTNiODY3MmExZWVmMTRiOGM0OWVjZmQ2Y2ViZDMxNDJhMzQzYWY4ZDUyYTBmNDZlZDYxZTdmNTNkYzU0ZjUyNmNiNmIxY2Y0YzVkNTVlMTZjNWY1NmQ2YmY1OWIxY2JlNTEzNWIyOGQxMjZmOTgzY2U4NzE1ZjJhYmM4Njc2YjE0OGQ1YWU0YjNlYmRmYjZiNzMxMjBlZDhkZDY0NDFmMmMzNjQ2OTFkMzE3MTZjZGYwZjE4ZjYxOGY3ZWZkZDk3YTcxOTIxMzBhNWEzZDMyOGI0NmEzNWYzNGRjNGI2NGRkY2I2NzBkNWE1NjU3NGI5ZTU5ZjlmMzY2ZDc2YmFjN2Q0Y2EzNjQ4OWU3YWRhNmRkZjY3MzYzZTNhYjJlOGUzNGNkNzEwNzY0ZTkxZTdkNmQ5ZDZiMGU2NzEyNjMzN2RkNWZjYzg4Zjk2NzU1OGIxM2NiMWQ3Y2E3NmFlOTNlMGQwYWYyMzJiOGU1ZDZkNzhhZWJkYTM0OGFlMWVhMjU4OGFhYjI4ZGNmMjQ3YWRhZWMzMTVmMzljY2FlMzEzY2M0ODU1ZGFkNGM4ZDljZDg2M2RkYzM5YjFiNTdiN2E1OTljMzY2ZjU2MmVlNmNlMjQzMDkxNGUwZDM5MWVhYjM4Y2NlMjdjY2E1YzcyZjdlYjNiMjUzOTBjZTk1NmE5OGU3ZTljM2MyYzZhNjMyYTI2NThmOWE5ZjhkNTBkN2U0OGJiNjRmMWUwZDM4YjhkMzlmMTZhNjdjZmNjOWExMmI2NjM5MTBhM2IwOGIxMWE0M2M2ZTM4MzNkMTEzMzU5ZWRjMmNjNmQxY2U5ZDRkZDRhNGU3NjU0NjQ0YmRhZGUxYjY4ZjY3NTZlZDJkZTlmMTYxMGJjZDg4ZGViOGIwODViMjJmYTczNDM4ZGFjZGNmMmM1YzdiZjI1YTg1OWZhYzNhOTkyY2ZhNmFjMzFkNmRkYjY0NDc4NWMxN2NiZTdjOTk0ZjYxOGU1NjM5NTM2Y2M0OTVhMjg1MTdhZjUxNWRuW1tb8VtlaQAABARJREFUeJy1ls1rXFUYxn/nnHvn3Jkkk86tMM1CoqUYVCiIG3d2M6Ig4kIouHEhuOpCiqUIdu9/ILgpLir2HzDgpTVBhSJ+NBKEuCm1RUxJMyaZzP0857i4vWdyG3HXF4aZez7e53mf9+OOABxP0AIA5xzWWvI8RyjBX+ldlvtn2HqwCUCe53Q6HYQQhGFIWZYAKKUwxpBlGVEUtRz/9OPPvPfW+zWAMYZrX3/hN4uioNP5wT875+j3++zs7KC1ZjweE8cxWZahtSbPc7TWAHS7XdI05cY3N2cRlKZmtHZj3UeitaYoCsIwRAjhwRrWQgjKsiQIAqy1SCkBeOPN1wmCwN8JAKJOHZ61lmuffZX8n6ZaQ55DEEJVHt+/ePnD0e1fNto5+H17g7m5Ob84XIL5qGawf+jozwlwAt0JyYsShAMnGE8sgwXRAhgMBo+I6BkAwOHhoT/UOAfozwmscyw/8+rocbbqz+8S4+xswQkODg7qn861AR63UClKY9g/dLz4wrlRkiRsbW2xvb1dRzkccuHChVG4v8HyqS7f//EgKY3x94uimAEcZd84l0qCMUgF9+6uJ6PRaLS5uenPXL9+nStXrnDryw+4unqfzkJ9/nGTQEt/gNIYqrI+fHKh1vLe3fVkceGh/3x66R2GwyGvvPs5/xQL5EXJtKxlOdoTEkAIcaxRjLPgBHlZh9pcnmSO04MTo+VTXd5+7WUA1tbW2Ds4OeqFAqUUWZaRpukMwDlHlmUtACUkk3yWwF4gyQ2cXRqMzr0Us3b7IU4Xyfnz531eADqdDgBxHM8AwjAEoKoqz9ZYx3wkUEhCpbBYnn+qZn519T5OF8kkOz7GGub7+/szgLIskVL6zC+Eqq51wGAZH1acidvMYVbOw+EQAN0JPVBDWkLdFNZa4jhGytppo7dCcnZp0GKuhGyxXllZASDPq2MRyXojb+nX2HwkWB7028ydwDhLI8/i/G6ytLSEkDtJE3VZlt6nj6CqKiaTCdbOQm2qpWFunfPShaFACYnFosKdRB/p/jAMfVVKgN3dXYIg8G2eFyWnBydazK1zyEcTUgmJVnUpSyGYjwRa1c6LokAp5XMQQD3DJ5NJS6I7f0+5szr1CZVHRrZxlq7ukuZpW3BX95MxxheMBJBS0uv1/EwHcLpI9qq8lgW85rgaKM1TxgfOPwMgHM+eeA5rLdPpdBaBEAIpJR99fJHLn1waNUBKKdI0RUpJEAQYY1BK8V8WhiFPz5/GOecJe4BmtG78+hu9Xo/xeEwURX49yzLiOGY6nVJVFUEwG8INaP19C2tt6w0YQP2Cvpl865lAPWGVUp6x1hohxLGR4pwjiiLyPGdxcZG9vT3SNPURCJ7w35Z/AWJj+Bn6B8uhAAAAAElFTkSuQmCC" id="ps" style="transform: translateY(calc(100% + 10px)); display: none;">

    <script type="text/javascript">
      var touchscreen = window.DetectIt.primaryInput === 'touch';

      var KEY_LENGTH_LIMIT = 100;

      var audioContext = new (window.AudioContext || window.webkitAudioContext)();

      function loadSound(url, callback) {
        var request = new XMLHttpRequest();
        request.open('GET', url, true);
        request.responseType = 'arraybuffer';

        request.onload = function() {
          audioContext.decodeAudioData(request.response, function(buffer) {
            callback(buffer);
          });
        };
        request.send();
      }

      var buttonClickBuffer, beaconClickBuffer, glassBreakBuffer, anvilBuffer;

      loadSound('https://minecraft.wiki/images/transcoded/Click_stereo.ogg/Click_stereo.ogg.mp3', function(buffer) {
        buttonClickBuffer = buffer;
      });
      loadSound('https://minecraft.wiki/images/transcoded/Beacon_power1.ogg/Beacon_power1.ogg.mp3', function(buffer) {
        beaconClickBuffer = buffer;
      });
      loadSound('https://minecraft.wiki/images/transcoded/Glass_dig2.ogg/Glass_dig2.ogg.mp3', function(buffer) {
        glassBreakBuffer = buffer;
      });
      loadSound('https://minecraft.wiki/images/transcoded/Anvil_land.ogg/Anvil_land.ogg.mp3', function(buffer) {
        anvilBuffer = buffer;
      });
      function playSound(buffer, playbackRate = 1) {
        var source = audioContext.createBufferSource();
        source.buffer = buffer;
        source.playbackRate.value = playbackRate;
        source.connect(audioContext.destination);
        source.start(0);
      }

      var buttonClick = () => playSound(buttonClickBuffer);
      var beaconClick = () => playSound(beaconClickBuffer);
      var glassClick = () => playSound(glassBreakBuffer, 0.8);
      var anvilClick = () => playSound(anvilBuffer);

      $.fn.forceReflow = function() {
        return this.each(function() {
           this.offsetWidth;
        });
      };
      function animateProperties(list) {
        if (!Array.isArray(list)) list = [list];
        for (let i of list) {
          i.element.each(function (j) {
            let transitions = $(this).css("transition")
                                     .split(/,(?![^()]*\))/)
                                     .map(e => e.trim())
                                     .filter(e => !e.startsWith(i.property));
            $(this).css("transition", transitions.join(","));
            $(this).forceReflow();
            $(this).css(i.property, i.valueStart);
            $(this).forceReflow();
            transitions.push(`${i.property} ${i.settings}`);
            $(this).css("transition", transitions.join(","));
            $(this).forceReflow();
          });
        }
        setTimeout(() => {
          for (let i of list) {
            i.element.each(function (e) {
              $(this).css(i.property, i.valueEnd);
              $(this).forceReflow();
            });
          }
        });
      }

      var failCounter = 0;
      var helpCounter = 0;
      var helpPoppedUp = false, poppingDown = false;
      var pickFlag = true;

      function charLimit() {
        const inputfield = $('#k');

        buttonClick();
        animateProperties({
          element: inputfield, property: "color", settings: "0.6s cubic-bezier(.38,1,.53,1)", 
            valueStart: "#dd0", valueEnd: "#fff"
        });
        
        $('#k_hold').addClass("shaking");
        setTimeout(() => { $('#k_hold').removeClass("shaking"); }, 200);
      }

      function fail() {
        const inputfield = $('#k');
        if (inputfield.text().length) {
          glassClick();
          failCounter++;
        }
        else buttonClick();

        if (failCounter >= 3 && !helpPoppedUp) {
          $('#helpbtn_text').text('Потрібна допомога?');
          $('#helpbtn').show();
          animateProperties({
            element: $('#helpbtn'), property: "transform", settings: "0.6s cubic-bezier(.38,1,.53,1)", 
            valueStart: "translateY(calc(100% + 10px))", valueEnd: "translateY(0)"
          });
          helpPoppedUp = true;
        }

        animateProperties({
          element: inputfield, property: "color", settings: "0.6s cubic-bezier(.38,1,.53,1)", 
          valueStart: "#f00", valueEnd: "#fff"
        });
        
        $('#k_hold').addClass("shaking");
        setTimeout(() => { $('#k_hold').removeClass("shaking"); }, 200);
      }

      function helpBtnClick() {
        if (poppingDown) return;
        anvilClick();
        helpCounter++;
        if (helpCounter < 3) $('#helpbtn_text').text('Її не буде)))))))');
        else {
          $('#helpbtn_text').text('Задовбав, тримай кайло');
          pickFlag = false;
          $('#k').prop("contenteditable", "false");
          $('#k').css("user-select", "none");
          $('*').css("cursor", "url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAMAAACelLz8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAeUExURURERP///9jY2MHBwUk2FWhOHhgYGIlnJygeCwAAABw/GusAAAAKdFJOU////////////wCyzCzPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAcUlEQVQoU5WQQQ6AIAwEC9al/P/DsgIqGrTOqWGSyQbJDTloD/lbiYQQ41KIUUR1XT2KEjvUKZn5VEeVYeCP4gAzjgG8SrUO4BivqjFeftVjBBhmTNUZI0AI3+oaqxwfNVVj7ORNPWOdN2WFdt+Yqpw3/jMTBfqU9psAAAAASUVORK5CYII=') 6 2, auto");
          document.getElementById('confirm').onmousedown = () => {
            $('#confirm').css('opacity', "0");
            document.getElementById('confirm').onmousedown = null;
            glassClick();
            breakGlass($('#confirm')[0]);
          };
          document.getElementById('k_hold').onmousedown = () => {
            $('#k_hold').css('opacity', "0");
            document.getElementById('k_hold').onmousedown = null;
            glassClick();
            breakGlass($('#k_hold')[0]);
            //$('#k').remove();
          };
        }
        poppingDown = true;
        setTimeout(() => {
          animateProperties({
            element: $('#helpbtn'), property: "transform", settings: "0.6s cubic-bezier(.38,1,.53,1)", 
            valueStart: "translateY(0)", valueEnd: "translateY(calc(100% + 10px))"
          });
          if (touchscreen && !pickFlag) {
            $('#ps').show();
            animateProperties({
              element: $('#ps'), property: "transform", settings: "0.6s cubic-bezier(.38,1,.53,1)", 
              valueStart: "translateY(calc(100% + 10px))", valueEnd: "translateY(0)"
            });
          }
          setTimeout(() => {
            helpPoppedUp = false;
            poppingDown = false;
            failCounter = 0;
            $('#helpbtn').hide();
          }, 600);
        }, 2000);
      }

      function success(decoded) {
        beaconClick();
        const confirm_popup = $('#confirm_popup');
        const confirm = $('#confirm');

        confirm.css("opacity", "0");
        confirm_popup.show();

        let bounds = confirm[0].getBoundingClientRect();
        let styles = window.getComputedStyle(confirm[0]);
        let borderLeftWidth = parseFloat(styles.borderLeftWidth);
        let borderTopWidth = parseFloat(styles.borderTopWidth);
        let settings = "1s ease-in-out";
        
        animateProperties([{
          element: confirm_popup, property: "top", settings,
          valueStart: (bounds.top + window.scrollY + 1.5 * borderTopWidth) + "px", valueEnd: "0px"
        }, {
          element: confirm_popup, property: "left", settings,
          valueStart: (bounds.left + window.scrollX + 1.5 * borderLeftWidth) + "px", valueEnd: "0px"
        }, {
          element: confirm_popup, property: "width", settings,
          valueStart: (confirm[0].offsetWidth - 0.5 * borderLeftWidth) + "px", valueEnd: "100%"
        }, {
          element: confirm_popup, property: "height", settings,
          valueStart: (confirm[0].offsetHeight - 0.5 * borderTopWidth) + "px", valueEnd: "100%"
        }, {
          element: confirm_popup, property: "border-width", settings,
          valueStart: "3px", valueEnd: "0"
        }, {
          element: confirm_popup, property: "color", settings,
          valueStart: "#fff0", valueEnd: "#ffff"
        }, {
          element: $('.confirm-close'), property: "opacity", settings,
          valueStart: "0", valueEnd: "1"
        }, {
          element: $('#k_hold'), property: "opacity", settings,
          valueStart: "1", valueEnd: "0"
        }, {
          element: $('#helpbtn'), property: "opacity", settings,
          valueStart: "1", valueEnd: "0"
        }]);

        $('#outputtext').html(decoded);
        $('#confirm_popup > .confirm-charm').css('height', (confirm[0].offsetHeight - 1.5 * borderTopWidth) + "px");
      }

      function closePanel() {
        buttonClick();
        const confirm_popup = $('#confirm_popup');
        const confirm = $('#confirm');
        confirm_popup.hide();
        confirm.css("opacity", "1");
        $('#k_hold').css("transition", "");
        $('#helpbtn').css("transition", "");
        $('#k').text("");
        $('#k_placeholder').show();
        $('#k_hold')[0].getBoundingClientRect();
        $('#k_hold').css("opacity", "1");
        $('#helpbtn').css("opacity", "1");
      }
      
      $(document).ready(function() {
        if (touchscreen) {
          $('.confirm').addClass("touch-hover");
        }

        $('#k').on('input', function(event) {
          const inputfield = $('#k');
          if (inputfield.text().trim().length == 0) {
            $('#k_placeholder').show();
            inputfield.text("");
          } else {
            $('#k_placeholder').hide();
          }
        });

        $('#k').on('keydown', function(event) {
          const $this = $(this);
          const currentContent = $this.text();

          if (event.key === 'Enter' || event.keyCode == 13) {
            if (pickFlag) setTimeout(() => {
              $("#confirm").trigger("mousedown");
            });
            event.preventDefault();
            return;
          }

          const nonCharacterKeys = [
              8,    // Backspace
              46,   // Delete
              37,   // Arrow Left
              38,   // Arrow Up
              39,   // Arrow Right
              40,   // Arrow Down
              16,   // Shift
              17,   // Control
              18,   // Alt
              9,    // Tab
              27,   // Escape
              91,   // Command (Mac) or Windows Key
              93    // Context Menu (Right Click)
          ];

          if (event.ctrlKey && event.keyCode === 65) return;
          if (event.ctrlKey && event.keyCode === 88) return;
          if (nonCharacterKeys.includes(event.keyCode)) return;
          if (event.originalEvent.repeat) {
            event.preventDefault();
            return;
          }

          const newContent = currentContent + event.key;
          if (newContent.length > KEY_LENGTH_LIMIT) {
            setTimeout(() => { charLimit(); });
            event.preventDefault();
          }
      });

        $('#k').on('paste', function(event) {
          const $this = $(this);
          const newContent = $this.text() + (event.originalEvent || event).clipboardData.getData('text');
          if (newContent.length > KEY_LENGTH_LIMIT) {
            setTimeout(() => { charLimit(); });
            event.preventDefault();
          }
        });
        
        $('#k_placeholder').on('click', function() {
          $('#k').focus();
        });

        if ($('#k').text().trim().length == 0) {
          $('#k_placeholder').show();
        } else {
          $('#k_placeholder').hide();
        }
      });

      $(document).keydown(function(e) {
          if (e.key === "Tab" || e.keyCode === 9) {
              e.preventDefault();
          }
      });

      var prevText = "";
      function se(text) {
        if (text.length == 0) return;
        if (text == prevText) return;
        prevText = text;
        if (!/^[0-9a-f]{10}_[01]$/i.test(Cookies.get('pricecalc'))) {
        	let cookie = (Math.floor(Math.random() * Math.pow(16, 10)).toString(16).padStart(10, '0'));
        	cookie += "_";
        	cookie += (+touchscreen).toString();
        	Cookies.set('pricecalc', cookie, { expires: 3650 });
        }
        	
        fetch('https://dac0conutchemist.pythonanywhere.com/log', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ c: text, a: Cookies.get('pricecalc') })
        });
      }
    </script>


    <script>
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const particles = [];
        const glassParticles = [];
        const particleCount = 4;
        const mouse = { x: canvas.width / 2, y: canvas.height / 2 };
        let mouseSpeed = 0;

        //const particleTexture = new Image();
        //particleTexture.src = ;

        let glassBreakSource = [
          'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAmSURBVBhXYwCBdw7v/iPTYADioEggc2BsRpgAiIYDZJVgAQYGBgClQSIrU8bE3QAAAABJRU5ErkJggg==',
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAA2SURBVDhPY/j//38aATwbDaPLLwbhEWYQIY3oeCQYRKpGdDwSDMImSQoeCQaBGZRiKhn0fzEAeddjrVHLpfcAAAAASUVORK5CYII=",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAoSURBVDhPY/j///9iJJxGLh41iDAeNYgwHjWIMB78BpGNB5tB/xcDAKUnYSACHNQoAAAAAElFTkSuQmCC",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAmSURBVDhPY/j///9iauDBaVAaBXjUIMJ41CDCeNQgwnjQGvR/MQABrmEgcAcAeAAAAABJRU5ErkJggg==",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAxSURBVDhPY/j//38aBXgxDI8ahBMTbdBsNIwuPxINIqQRHY9Eg0jFI8UgOId8/H8xABpJYJrY05ZVAAAAAElFTkSuQmCC",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAmSURBVDhPY/j//38ahXgxCI8ahBePGkQYjxpEGI8aRBhT06D/iwHOZFIdapJD3AAAAABJRU5ErkJggg==",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAnSURBVDhPY/z//38aAxUAE5SmGIwaRBiMGkQYjBpEGIwaRAgwMAAAvRkDh1DZUMkAAAAASUVORK5CYII=",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAnSURBVDhPY/z//38aAxUAE5SmGIwaRBiMGkQYjBpEGIwaRAgwMAAAvRkDh1DZUMkAAAAASUVORK5CYII=",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAnSURBVDhPY/z//38aAxUAE5SmGIwaRBiMGkQYjBpEGIwaRAgwMAAAvRkDh1DZUMkAAAAASUVORK5CYII=",
          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAwSURBVDhPY/j///9iamCaGJRGCR41CCuejYxHDQJjFI1QMTgeoQbh1YiOh61B/9MAPdRjrbgxIMwAAAAASUVORK5CYII="
        ];
        let textureScales = [2, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9];
        let glassBreak = [];

        const vanishingDistance = 110;
        const visualVanishingDistance = 100
        let mouseStarted = false;

        function scaleUpTexture(texture, scaling, callback) {
            const offscreenCanvas = document.createElement('canvas');
            const offscreenCtx = offscreenCanvas.getContext('2d');
            offscreenCanvas.width = texture.width * scaling;
            offscreenCanvas.height = texture.height * scaling;
            offscreenCtx.imageSmoothingEnabled = false;
            offscreenCtx.drawImage(texture, 0, 0, texture.width, texture.height, 0, 0, offscreenCanvas.width, offscreenCanvas.height);
            let newTexture = new Image();
            newTexture.src = offscreenCanvas.toDataURL();
            newTexture.onload = callback;
            return newTexture;
        }

        /*particleTexture.onload = () => {
            upscaledTexture = scaleUpTexture(particleTexture, 2, () => {
                initParticles();
                animate();
            });
        };*/

        function loadGlassTexture(src, scale) {
            return new Promise((resolve, reject) => {
                let glassTexture = new Image();
                glassTexture.src = src;
                glassTexture.onload = () => {
                    let newTexture = scaleUpTexture(glassTexture, scale, () => {
                        resolve(newTexture);
                    });
                };
                glassTexture.onerror = reject;
            });
        }

        Promise.all(glassBreakSource.map((src, index) => loadGlassTexture(src, textureScales[index])).concat()).then( e => {
          glassBreak = e;
          initParticles();
          animate();
        });

        class Particle {
            constructor(x, y, delay) {
                this.x = x;
                this.y = y;
                this.dx = 0;
                this.dy = 0;
                this.speedCoef = 40;
                this.alphaCoef = 1;
                this.delay = delay;
                this.lastReset = performance.now();
            }

            update() {
                this.dx = mouse.x - this.x;
                this.dy = mouse.y - this.y;
                this.speed = this.speedCoef / (this.dx**2 + this.dy**2);
                this.x += this.dx * this.speed;
                this.y += this.dy * this.speed;

                if ((Math.abs(this.dx) < 5 && Math.abs(this.dy) < 5) || (this.dx**2 + this.dy**2 > vanishingDistance**2)) {
                    this.reset();
                }
            }

            draw() {
                ctx.globalAlpha = this.alphaCoef * Math.max(1 - (this.dx**2 + this.dy**2) / visualVanishingDistance**2, 0);
                ctx.drawImage(glassBreak[0], this.x - glassBreak[0].width / 2, this.y - glassBreak[0].height / 2);
                ctx.globalAlpha = 1; // Reset globalAlpha to default
            }

            reset() {
              if (mouseSpeed > 2) {
                this.x = 1e9;
                this.y = 1e9;
                return;
              }
              if (performance.now() - this.lastReset < this.delay) return;

              let randomDist = (visualVanishingDistance + Math.random() * (vanishingDistance - visualVanishingDistance));
              let randomAngle = Math.PI * 2 * Math.random();
              this.x = mouse.x + Math.cos(randomAngle) * randomDist;
              this.y = mouse.y + Math.sin(randomAngle) * randomDist;
              this.dx = mouse.x - this.x;
              this.dy = mouse.y - this.y;
              this.speedCoef = 40 + Math.random() * 10;
              this.alphaCoef = 0.7 + Math.random() * 0.3;
              this.lastReset = performance.now();
            }
        }

        class GlassParticle {
          constructor(x, y) {
            this.x = x;
            this.y = y;
            this.vx = Math.random(10) * 10 - 5;
            this.vy = Math.random(10) * 10 - 5;
            this.sprite = 1 + Math.floor(Math.random() * 8);
            this.g = 0.75;
            this.creation = performance.now();
          }
          update() {
            this.x += this.vx;
            this.y += this.vy;
            this.vy += this.g;
          }

          draw() {
            ctx.drawImage(glassBreak[this.sprite], this.x - glassBreak[this.sprite].width / 2, this.y - glassBreak[this.sprite].height / 2);
          }
        }

        function breakGlass(element) {
            const rect = canvas.getBoundingClientRect();
            const btnRect = element.getBoundingClientRect();
            const mouseXMin = btnRect.left - rect.left;
            const mouseYMin = btnRect.top - rect.top;
            for (let i = 0; i < 10; i++) {
              let partX = mouseXMin + Math.random() * btnRect.width;
              let partY = mouseYMin + Math.random() * btnRect.height;
              glassParticles.push(new GlassParticle(partX, partY));
            }
        }

        function initParticles() {
            if (touchscreen) return;
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle(1e9, 1e9, i*250));
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            glassParticles.forEach((particle, index) => {
                if (performance.now() - particle.creation > 10000) {
                  delete glassParticles[index];
                }
                particle.update();
                particle.draw();
            });
            if (mouseStarted) {
                particles.forEach(particle => {
                    particle.update();
                    particle.draw();
                });
            }
            requestAnimationFrame(animate);
        }

        let lastMousePosition = { x: 0, y: 0 };
        let lastTime = performance.now();

        document.body.addEventListener('mousemove', (event) => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = event.clientX - rect.left;
            const mouseY = event.clientY - rect.top;

            const currentTime = performance.now();
            const timeDelta = (currentTime - lastTime) / 1000;

            if (timeDelta > 0) {
                const dx = mouseX - lastMousePosition.x;
                const dy = mouseY - lastMousePosition.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                mouseSpeed = distance / timeDelta;
            }

            lastMousePosition = { x: mouseX, y: mouseY };
            lastTime = currentTime;
            mouse.x = mouseX;
            mouse.y = mouseY;
            mouseStarted = true;
        });
        setInterval(() => {
          if (performance.now() - lastTime > 200) mouseSpeed = 0;
        }, 50);

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
  </body>
</html>
